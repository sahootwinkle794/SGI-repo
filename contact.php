<?php include 'header.php'; ?>

    <!--Page Header Start-->
        <section class="page-header">
            <div class="page-header__bg" style="background-image: url(assets/images/backgrounds/page-header-bg.png);">
            </div>
            <div class="container">
                <div class="page-header__inner">
                    <h3>Contact </h3>
                    <div class="thm-breadcrumb__inner">
                        <ul class="thm-breadcrumb list-unstyled">
                            <li><a href="index.html">Home</a></li>
                            <li><span class="fas fa-angle-right"></span></li>
                            <li>Contact </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    <!--Page Header End-->

    <!--Contact Info Start-->
        <section class="contact-info">
            <div class="container">
                <div class="row">
                    <!--Contact Two Single Start-->
                    <div class="col-xl-6 col-lg-4 wow fadeInLeft" data-wow-delay="100ms">
                        <div class="contact-info__single">
                            <div class="contact-info__icon">
                                <span class="icon-call"></span>
                            </div>
                            <p>Contact Us</p>
                            <div class="con-num">
                                <h3><a href="tel:+918886665318">+91 888 666 5318, </a></h3>
                                <h3 class="ms-2"><a href="tel:+918886665318">+91 888 666 5318, </a></h3>
                                <h3 class="ms-2"><a href="tel:+918886665318">+91 888 666 5318</a></h3>
                            </div>

                        </div>
                    </div>
                    <!--Contact Two Single End-->
                    <!--Contact Two Single Start-->
                    <div class="col-xl-6 col-lg-4 wow fadeInUp" data-wow-delay="200ms">
                        <div class="contact-info__single">
                            <div class="contact-info__icon">
                                <span class="icon-email"></span>
                            </div>
                            <p>Mail Us</p>
                            <h3><a href="mailto:vivek@sukshmagamma.com">vivek@sukshmagamma.com</a></h3>
                        </div>
                    </div>
                    <!--Contact Two Single End-->
                    <!--Contact Two Single Start-->
                    <div class="col-xl-6 col-lg-4 wow fadeInRight" data-wow-delay="300ms">
                        <div class="contact-info__single">
                            <div class="contact-info__icon">
                                <span class="icon-pin"></span>
                            </div>
                            <p>Registered Office:</p>
                            <h5>Sukshma Gamma LLP
                            </h5>
                            <h3>73-1-10, Thotavari Street,<br> Patamata Vijayawada,Andhra Pradesh</h3>

                        </div>
                    </div>
                    <!--Contact Two Single End-->
                    <!--Contact Two Single Start-->
                    <div class="col-xl-6 col-lg-4 wow fadeInRight" data-wow-delay="300ms">
                        <div class="contact-info__single">
                            <div class="contact-info__icon">
                                <span class="icon-pin"></span>
                            </div>
                            <p>Plant:</p>
                            <h5>Sukshma Gamma LLP
                            </h5>
                            <h3>Plot No : 1B, APIIC, Model Industrial Park, Mallavalli, Krishna Dist. Andhra Pradesh
                            </h3>

                        </div>
                    </div>
                    <!--Contact Two Single End-->
                </div>
            </div>
        </section>
    <!--Contact Info End-->

    <!--Contact Page Start-->
        <section class="contact-page">
            <div class="container">
                <div class="contact-page__inner">
                    <div class="row">
                        <div class="col-xl-6">
                            <div class="contact-page__left">
                                <h4 class="text-white mb-3">Registered Office:</h4>
                                <iframe
                                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3825.6615804449643!2d80.6616539751052!3d16.492665027963234!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3a35fac2eeb63f59%3A0xec0a653da3be3012!2s73-1-11%2F3%2C%20Thotavari%20St%2C%20JD%20Nagar%2C%20Patamata%2C%20Benz%20Circle%2C%20Vijayawada%2C%20Andhra%20Pradesh%20520010!5e0!3m2!1sen!2sin!4v1765965867811!5m2!1sen!2sin"
                                    width="600" height="250" style="border:0;" allowfullscreen="" loading="lazy"
                                    referrerpolicy="no-referrer-when-downgrade"></iframe>
                                <h4 class="text-white mb-3 mt-4">Plant:</h4>
                                <iframe
                                    src="https://www.google.com/maps/embed?pb=!1m16!1m12!1m3!1d15286.038434912409!2d80.88221074956137!3d16.70140564779842!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!2m1!1sPlot%20No%20%3A%201B%2C%20APIIC%2C%20Model%20Industrial%20Park%2C%20Mallavalli%2C%20Krishna%20Dist.%20Andhra%20Pradesh!5e0!3m2!1sen!2sin!4v1765966077445!5m2!1sen!2sin"
                                    width="600" height="250" style="border:0;" allowfullscreen="" loading="lazy"
                                    referrerpolicy="no-referrer-when-downgrade"></iframe>
                            </div>
                        </div>
                        <div class="col-xl-6">
                            <div class="contact-page__right contact-form">
                                <h3 class="contact-page__form-title">Get A Free Quote</h3>
                                <!-- <form id="contactForm" class="needs-validation contact-page__form"
                                    action="https://dreamlayout.mnsithub.com/html/farmology/main-html/assets/mail.php" method="POST"> -->
                                <form id="contactForm" method="POST">
                                    <div class="row">
                                        <div class="col-xl-6 col-lg-6 col-md-6">
                                            <div class="contact-page__input-box">
                                                <input type="text" name="name" placeholder="Your name" required>
                                                <small class="error-name invalid-feedback"></small>
                                            </div>
                                        </div>
                                        <div class="col-xl-6 col-lg-6 col-md-6">
                                            <div class="contact-page__input-box">
                                                <input type="email" name="email" placeholder="Your Email" required>
                                                <small class="error-email invalid-feedback"></small>
                                            </div>
                                        </div>
                                        <div class="col-xl-6 col-lg-6 col-md-6">
                                            <div class="contact-page__input-box">
                                                <input type="text" placeholder="Mobile" name="number" required>
                                                <small class="error-number invalid-feedback"></small>
                                            </div>
                                        </div>
                                        <div class="col-xl-6 col-lg-6 col-md-6">
                                            <div class="contact-page__input-box">
                                                <input type="text" placeholder="Company" name="company" required>
                                                <small class="error-company invalid-feedback"></small>
                                            </div>
                                        </div>
                                        <div class="col-xl-12">
                                            <div class="contact-page__input-box text-message-box">
                                                <textarea name="message" placeholder="Messege" required></textarea>
                                                <small class="error-message invalid-feedback"></small>
                                            </div>
                                            <div class="contact-page__btn-box">
                                                <button type="submit" class="thm-btn contact-page__btn"
                                                    data-loading-text="Please wait...">
                                                    Send A Message
                                                    <i class="fal fa-long-arrow-right"></i>
                                                    <span class="hover-btn hover-bx"></span>
                                                    <span class="hover-btn hover-bx2"></span>
                                                    <span class="hover-btn hover-bx3"></span>
                                                    <span class="hover-btn hover-bx4"></span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <p class="ajax-response mb-0"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    <!--Contact Page End-->

<?php include 'footer.php'; ?>
<script src="assets/js/script.js"></script>
<script>
        (function () {
            'use strict';

            const forms = document.querySelectorAll('.needs-validation');

            Array.from(forms).forEach(function (form) {
                form.addEventListener('submit', function (event) {

                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }

                    form.classList.add('was-validated');
                }, false);
            });
        })();
        //  function loadCaptcha() {
        //     $.ajax({
        //        url: "generate_captcha.php",
        //        type: "GET",
        //        dataType: "json",
        //        success: function(res) {
        //              $("#captchaCode").text(res.captcha);
        //        }
        //     });
        //  }

        //  loadCaptcha();

        //  $("#refreshCaptcha").click(function() {
        //     loadCaptcha();
        //  });

            $("input[name='name']").on("input", function () {
                let name = $(this).val().trim();
                if (/^[A-Za-z ]{3,80}$/.test(name)) {
                    $(".error-name").text("");
                    $(this).removeClass("is-invalid");
                } else {
                    $(".error-name").text("Name must be 3-80 characters (letters & spaces only)");
                    $(this).addClass("is-invalid");
                }
            });

           $("input[name='number']").on("input", function () {
                let number = $(this).val().trim();
                if (/^[6-9][0-9]{9}$/.test(number)) {
                    $(".error-number").text("");
                    $(this).removeClass("is-invalid");
                } else {
                    $(".error-number").text("Enter a valid 10-digit Indian mobile number");
                    $(this).addClass("is-invalid");
                }
            });


            $("input[name='email']").on("input", function () {
                let email = $(this).val().trim();
                if (/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,}$/.test(email)) {
                    $(".error-email").text("");
                    $(this).removeClass("is-invalid");
                } else {
                    $(".error-email").text("Enter a valid email address");
                    $(this).addClass("is-invalid");
                }
            });

            $("input[name='company']").on("input", function () {
                let company = $(this).val().trim();
                if (/^[A-Za-z ]{3,80}$/.test(company)) {
                    $(".error-company").text("");
                    $(this).removeClass("is-invalid");
                } else {
                    $(".error-company").text("Company must be 3-80 characters (letters & spaces only)");
                    $(this).addClass("is-invalid");
                }
            });

            $("textarea[name='message']").on("input", function () {
                let message = $(this).val().trim();
                if (/^[A-Za-z0-9 .,!?@#()\-_\r\n]{10,1000}$/s.test(message)) {
                    $(".error-message").text("");
                    $(this).removeClass("is-invalid");
                } else {
                    $(".error-message").text("Message must be 10-1000 characters.");
                    $(this).addClass("is-invalid");
                }
            });

        // $("input[name='captcha_input']").on("input", function () {
        //    let captcha = $(this).val().trim();

        //    if (captcha.length !== 6) {
        //       $(".error-captcha").text("Enter valid captcha");
        //    } else {
        //       $(".error-captcha").text("");
        //    }
        // });

        $("#contactForm").on("submit", function (e) {
            e.preventDefault();

            $(".text-danger").text("");

            let isValid = true;

            let name = $("input[name='name']").val().trim();
            let number = $("input[name='number']").val().trim();
            let email = $("input[name='email']").val().trim();
            let company = $("input[name='company']").val().trim();
            let message = $("textarea[name='message']").val().trim();
            // let captcha = $("input[name='captcha_input']").val().trim();

            // Escape HTML to prevent XSS (client side)
            const escapeInput = str => $("<div>").text(str).html();

            name = escapeInput(name);
            number = escapeInput(number);
            email = escapeInput(email);
            company = escapeInput(company);
            message = escapeInput(message);
            // captcha = escapeInput(captcha);


            // if (!/^[A-Za-z ]{3,80}$/.test(name)) {
            //    $(".error-name").text("Name must be 3-80 characters (letters & spaces only)");
            //    isValid = false;
            // }

            // if (!/^[6-9][0-9]{9}$/.test(number)) {
            //    $(".error-number").text("Enter a valid 10 digits mobile number");
            //    isValid = false;
            // }


            // if (!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,}$/.test(email)) {
            //    $(".error-email").text("Enter a valid email address");
            //    isValid = false;
            // }

            // if (!/^[A-Za-z ]{3,80}$/.test(company)) {
            //    $(".error-company").text("Company must be 3-80 characters (letters & spaces only)");
            //    isValid = false;
            // }

            // if (!/^[A-Za-z0-9 .,!?@#()\-_\r\n]{10,1000}$/s.test(message)) {
            //    $(".error-message").text("Message must be 10-1000 characters. Allowed: letters, numbers, spaces & common symbols.");
            //    isValid = false;
            // }

            // if (captcha.length !== 6) {
            //    $(".error-captcha").text("Enter valid captcha");
            //    isValid = false;
            // }

            // reCAPTCHA validation
            // let recaptcha = grecaptcha.getResponse();
            // if (recaptcha.length === 0) {
            //    $(".error-recaptcha").text("Please verify you are not a robot");
            //    isValid = false;
            // } else {
            //    $(".error-recaptcha").text("");
            // }

            if (!isValid) {
                //    grecaptcha.reset(); 
                return;
            }

            $.ajax({
                url: "mail.php",
                type: "POST",
                dataType: "json",
                data: $("#contactForm").serialize(),
                beforeSend: function () {
                    $(".btn-submit").attr("disabled", true).text("Sending...");
                    $("#pageLoader").show();
                },
                success: function (res) {
                    $(".alert").remove();
                    //  if (res.status !== "success") {
                    //     grecaptcha.reset(); 
                    //  }

                    //  const alertHTML = `
                    //     <div class="alert alert-${res.status === "success" ? "success" : "danger"}">
                    //        ${res.status === "success" ? "‚úî" : "‚ùå"} ${res.message}
                    //     </div>
                    //  `;
                    const alertHTML = `
                        <div class="alert alert-${res.status === "success" ? "success" : "danger"} alert-dismissible fade show">
                            <button type="button" class="btn-close alert-close" aria-label="Close"></button>
                            ${res.status === "success" ? "‚úî" : "‚ùå"} ${res.message}
                        </div>
                    `;

                    $(".contact-form").prepend(alertHTML);

                    // üëâ manual close button handler
                    $(document).on("click", ".alert-close", function () {
                        $(this).closest(".alert").fadeOut(300, function () {
                            $(this).remove();
                        });
                    });

                    // short robust scroll to the newly added alert
                    setTimeout(function () {
                        const container = $(".page-wrapper");
                        const alertBox = $(".contact-form .alert").first();
                        if (!container.length || !alertBox.length) return;

                        const cRect = container[0].getBoundingClientRect();
                        const aRect = alertBox[0].getBoundingClientRect();

                        const target = Math.max(0, Math.round(container.scrollTop() + (aRect.top - cRect.top) - 20));

                        container.stop(true, true).animate({ scrollTop: target }, 450);
                        // quick re-scroll to defeat other scripts that may run right after
                        setTimeout(() => container.stop(true, true).animate({ scrollTop: target }, 300), 300);
                    }, 200);

                    // remove alert after 20 seconds
                    setTimeout(() => {
                        $(".contact-form .alert").fadeOut(400, function () {
                            $(this).remove();
                        });
                    }, 20000);

                    if (res.status === "success") {
                        $("#contactForm")[0].reset();
                        //loadCaptcha();
                        //grecaptcha.reset(); 
                    }
                },
                error: function () {
                    $(".contact-form").prepend(`
                        <div class="alert alert-danger">
                           ‚ùå Something went wrong!
                        </div>
                     `);
                },
                complete: function () {
                    $(".btn-submit").attr("disabled", false).text("Send Message");
                    $("#pageLoader").hide();
                }
            });
        });

    </script>